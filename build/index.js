#!/usr/bin/env node

(()=>{"use strict";var e={154:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DEV_PATH=void 0,t.DEV_PATH=""},722:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LOG_ERROR=t.ENTRY_DIR=t.IMAGE_DIR=t.MD_NAME=void 0,t.MD_NAME="index.md",t.IMAGE_DIR="/images",t.ENTRY_DIR="/entry",t.LOG_ERROR="[Error]:"},55:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.articleDateCheck=void 0;const n=r(920),i=/published_date:.*/,o=/modified_date:.*/,a=(e,t)=>{const r=e.find((e=>t.test(e)));return r?.replace(/(published|modified)_date:\s*/,"")??null},s=(e,t)=>{const r=[];return e||r.push("published_date"),t||r.push("modified_date"),r},u=e=>`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")}`;t.articleDateCheck=e=>{var t;(0,n.printErrorLog)(((e,t)=>{if(!e||!t)return[`${s(e,t)}が抜けています。`];const r=u(new Date),n=[];return e>t&&n.push(`公開日と更新日が不整合です。更新日より公開日の方が新しくなっています。\npublished_date: ${e}\nmodified_date: ${t}`),e>r&&n.push(`公開日に未来の日付が登録されています。\n今日の日付：${r}\npublished_date: ${e}`),t>r&&n.push(`更新日に未来の日付が登録されています。\n今日の日付：${r}\nmodified_date: ${t}`),n})(a(t=e,i),a(t,o)))}},175:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.articleHeadingLevelCheck=void 0;const n=r(920),i=/(<h[1256]>(?<!title:).+<\/h[1256]>)|(\n<p>#{2,}.+)/g,o=/<h[1256]>(?<!title:).+<\/h[1256]>/g,a=/<p>#{2,}\u3000.+/g,s=/<p>#{2,}[^#|\s]+/g,u=/<p>(#{2}|#{5,})(\s|\u3000|[^#]).+/g;t.articleHeadingLevelCheck=e=>{(0,n.printErrorLog)((e=>{const t=e.match(i),r=[];return t?.forEach((e=>{const t=[];if(o.test(e)&&t.push("使用できない見出しレベルです。h3とh4が使用できます。\n"),a.test(e)&&(e.match(a),t.push("全角スペースが含まれているためpタグに変換されています。")),s.test(e)&&(e.match(s),t.push("#の直後に半角スペースがないためpタグに変換されています。")),u.test(e)&&(e.match(u),t.push("使用できない見出しレベルです。h3とh4が使用できます。")),t.length>0){const n=t.join(",").replace(/,/g,"\n")+e;r.push(n)}})),r})(e))}},524:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.articleRelatedCheck=void 0;const n=r(920),i=/---(.|\n)+related:.+\n(.|\n)+---/,o=/related:.+\n/,a=e=>{const t=Math.abs(8-e.length);return e.length>8?`関連記事が${t}点多いです。\n`:e.length<8?`関連記事が${t}点足りません。\n`:""},s=(e,t)=>e.length!==t.length,u=(e,t)=>s(e,t)?"関連記事が重複しています。\n":"",l=e=>e.join(",");t.articleRelatedCheck=e=>{(0,n.printErrorLog)((e=>{const t=e.match(i);if(!t)return["関連記事が存在しません。"];const r=t[0].match(o);if(!r)return[];return(e=>{const t=[...new Set(e)];return(e=>8===e.length)(e)&&!s(e,t)?[]:[a(e)+u(e,t)+l(e)]})(r[0].replace(/^related:|,\s*\n$|\s*\n$/g,"").split(","))})(e))}},930:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.expiredLinkCheck=void 0;const i=r(757),o=n(r(167)),a=r(920);t.expiredLinkCheck=async e=>{const t=e.flatMap((e=>e.split(/["']/))).filter(i.notNull).filter((e=>e.startsWith("http"))).map((e=>new Promise(((t,r)=>{o.default.get(e).then((r=>t({link:e,statusCode:r.status,statusText:r.statusText}))).catch((t=>r({link:e,message:t.message})))})))),r=(await Promise.allSettled(t)).filter((e=>"rejected"===e.status||200!==e.value.statusCode)).map((e=>"rejected"===e.status?`${e.reason.message} link:\n${e.reason.link}`:`${e.value.statusCode.toString()} ${e.value.statusText} link:\n${e.value.link}`));(0,a.printErrorLog)(r),(0,a.printNoProblemLog)()}},807:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.eyecatchCheck=void 0;const i=r(454),o=r(722),a=n(r(219)),s=r(837),u=r(920),l=(0,s.promisify)(a.default),c=["jpg","png"];t.eyecatchCheck=async e=>{const t=(0,i.readDirectory)(`${e}${o.IMAGE_DIR}`).filter((e=>e.name.startsWith("eyecatch")));if(0===t.length)return void(0,u.printErrorLog)(["アイキャッチ画像が存在しません。"]);const r=await d(`${e}${o.IMAGE_DIR}/${t.at(0)?.name}`);(0,u.printErrorLog)(r)};const d=async e=>{const t=await l(e),r=[];return t?(t.type&&c.includes(t.type)||r.push(`アイキャッチ画像の形式はjpgかpngのみ有効です。type:${t.type}`),1280!==t.width&&r.push(`アイキャッチ画像の横幅は1280pxである必要があります。width:${t.width}`),512!==t.height&&r.push(`アイキャッチ画像の縦幅は512pxである必要があります。height:${t.height}`),r):(r.push("アイキャッチ画像が不正です。"),r)}},260:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.fileCapacityCheck=void 0;const i=n(r(561)),o=r(722),a=r(454),s=r(920);t.fileCapacityCheck=e=>{let t=0;t+=u(`${e}/${o.MD_NAME}`),(0,a.readDirectory)(`${e}${o.IMAGE_DIR}`).forEach((r=>{t+=u(`${e}${o.IMAGE_DIR}/${r.name}`)}));const r=t/1048576,n=r>10?[`容量が10MBを超えています。size: ${Math.round(r)}MB `]:[];(0,s.printErrorLog)(n)};const u=e=>i.default.statSync(e).size},841:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getPath=void 0;const i=n(r(650)),o=r(154),a=n(r(282)),s=r(722);t.getPath=async()=>"development"===a.default.env.NODE_ENV?o.DEV_PATH:await u();const u=async()=>{const e=(await(0,i.default)({type:"text",message:"記事IDを指定ください。 例) 200317",name:"value"})).value.replace(/(http.+ics.media\/entry\/)|\/$/g,"");return`${a.default.cwd()}${s.ENTRY_DIR}/${e}`}},757:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.notNull=void 0,t.notNull=e=>null!=e},920:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.printNoProblemLog=t.printErrorLog=void 0;const a=r(722),s=o(r(206));let u=0;t.printErrorLog=e=>{e.length>0&&(u++,e.forEach((e=>s.warn(`${a.LOG_ERROR}${e}`))))},t.printNoProblemLog=()=>{0===u&&s.log("✨ この記事に問題はありませんでした。")}},454:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.readDirectory=void 0;const i=n(r(561)),o=n(r(282)),a=r(722);t.readDirectory=e=>{try{return i.default.readdirSync(e,{withFileTypes:!0})}catch(t){console.warn(`${a.LOG_ERROR}ディレクトリが存在しません。${e}`),o.default.exit(1)}}},685:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.readFile=void 0;const i=n(r(561)),o=n(r(282)),a=r(722);t.readFile=e=>{try{return i.default.readFileSync(e,"utf-8")}catch(t){console.warn(`${a.LOG_ERROR}ファイルが存在しません。${e}`),o.default.exit(1)}}},822:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.toHtml=void 0;const i=n(r(653)),o=/\n/g;t.toHtml=e=>(new i.default).render(e).split(o)},938:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.toHtmlText=void 0;const i=n(r(653));t.toHtmlText=e=>(new i.default).render(e)},167:e=>{e.exports=require("axios")},219:e=>{e.exports=require("image-size")},653:e=>{e.exports=require("markdown-it")},650:e=>{e.exports=require("prompts")},206:e=>{e.exports=require("console")},561:e=>{e.exports=require("node:fs")},282:e=>{e.exports=require("process")},837:e=>{e.exports=require("util")}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,r),o.exports}(()=>{const e=r(841),t=r(685),n=r(722),i=r(822),o=r(938),a=r(175),s=r(930),u=r(260),l=r(807),c=r(55),d=r(524);(async()=>{const r=await(0,e.getPath)(),p=(0,t.readFile)(`${r}/${n.MD_NAME}`),h=(0,i.toHtml)(p),f=(0,o.toHtmlText)(p);(0,s.expiredLinkCheck)(h),(0,u.fileCapacityCheck)(r),(0,l.eyecatchCheck)(r),(0,a.articleHeadingLevelCheck)(f),(0,d.articleRelatedCheck)(p),(0,c.articleDateCheck)(h)})()})()})();