#!/usr/bin/env node

(()=>{"use strict";var e={154:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DEV_PATH=void 0,t.DEV_PATH=""},722:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LOG_INFO=t.LOG_ERROR=t.LOG_SEPARATOR=t.ENTRY_DIR=t.IMAGE_DIR=t.MD_NAME=void 0,t.MD_NAME="index.md",t.IMAGE_DIR="/images",t.ENTRY_DIR="/entry",t.LOG_SEPARATOR="-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-",t.LOG_ERROR="[Error]:",t.LOG_INFO="[Info]:"},55:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.articleDateCheck=void 0;const n=r(920),o=/published_date:.*/,a=/modified_date:.*/,i=(e,t)=>{const r=e.find((e=>t.test(e)));return r?.replace(/(published|modified)_date:\s*/,"")??null},s=(e,t)=>{const r=[];return e||r.push("published_date"),t||r.push("modified_date"),r},l=e=>`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")}`;t.articleDateCheck=e=>{var t;(0,n.printErrorLog)(["記事公開日と更新日の整合性のチェックを行います。"],((e,t)=>{if(!e||!t)return[`${s(e,t)}が抜けています。`];const r=l(new Date),n=[];return e>t&&n.push(`公開日と更新日が不整合です。更新日より公開日の方が新しくなっています。\npublished_date: ${e}\nmodified_date: ${t}`),e>r&&n.push(`公開日に未来の日付が登録されています。\n今日の日付：${r}\npublished_date: ${e}`),t>r&&n.push(`更新日に未来の日付が登録されています。\n今日の日付：${r}\nmodified_date: ${t}`),n})(i(t=e,o),i(t,a)))}},175:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.articleHeadingLevelCheck=void 0;const n=r(920),o=/\n#+.+/g,a=/\n(#{1,2}|#{5,})(\s|\u3000|[^#]).+/g,i=/\n#+\u3000.+/g,s=/\n#+[^#|\s]+/g;t.articleHeadingLevelCheck=e=>{(0,n.printErrorLog)(["見出しレベルのチェックを行います。"],(e=>{const t=e.match(o);if(!t)return[];const r=[];return t.forEach((e=>{const t=[];if(a.test(e)&&(e.match(a),t.push("使用できない見出しレベルです。h3とh4が使用できます。")),i.test(e)&&(e.match(i),t.push("全角スペースが含まれています。")),s.test(e)&&(e.match(s),t.push("#の直後に半角スペースがありません。")),t.length>0){const n=t.join(",").replace(/,/g,"\n")+e;r.push(n)}})),r})(e))}},524:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.articleRelatedCheck=void 0;const n=r(920),o=/---(.|\n)+related:.+\n(.|\n)+---/,a=/related:.+\n/,i=e=>{const t=Math.abs(8-e.length);return e.length>8?`関連記事が${t}点多いです。\n`:e.length<8?`関連記事が${t}点足りません。\n`:""},s=(e,t)=>e.length!==t.length,l=(e,t)=>s(e,t)?"関連記事が重複しています。\n":"",u=e=>e.join(",");t.articleRelatedCheck=e=>{const t=(e=>{const t=e.match(o);if(!t)return["関連記事が存在しません。"];const r=t[0].match(a);if(!r)return[];return(e=>{const t=[...new Set(e)];return(e=>8===e.length)(e)&&!s(e,t)?[]:[i(e)+l(e,t)+u(e)]})(r[0].replace(/^related:|,\s*\n$|\s*\n$/g,"").split(","))})(e);(0,n.printErrorLog)(["関連記事の個数チェックを行います。"],t)}},930:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.expiredLinkCheck=void 0;const o=r(757),a=n(r(167)),i=r(920);t.expiredLinkCheck=async e=>{const t=e.flatMap((e=>e.split(/["']/))).filter(o.notNull).filter((e=>e.startsWith("http"))).map((e=>new Promise(((t,r)=>{a.default.get(e).then((r=>t({link:e,statusCode:r.status,statusText:r.statusText}))).catch((t=>r({link:e,message:t.message})))})))),r=(await Promise.allSettled(t)).filter((e=>"rejected"===e.status||200!==e.value.statusCode)).map((e=>"rejected"===e.status?`${e.reason.message} link:${e.reason.link}`:`${e.value.statusCode.toString()} ${e.value.statusText} link:${e.value.link}`));(0,i.printErrorLog)(["リンク切れのチェックを行います。"],r)}},807:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.eyecatchCheck=void 0;const o=r(454),a=r(722),i=n(r(219)),s=r(837),l=r(920),u=(0,s.promisify)(i.default),c=["jpg","png"];t.eyecatchCheck=async e=>{const t=(0,o.readDirectory)(`${e}${a.IMAGE_DIR}`).filter((e=>e.name.startsWith("eyecatch")));if(0===t.length)return void(0,l.printErrorLog)(["アイキャッチ画像をチェックします。",`${e}${a.IMAGE_DIR}`],["アイキャッチ画像が存在しません。"]);const r=await d(`${e}${a.IMAGE_DIR}/${t.at(0)?.name}`);(0,l.printErrorLog)(["アイキャッチ画像をチェックします。",`${e}${a.IMAGE_DIR}/${t.at(0)?.name}`],r)};const d=async e=>{const t=await u(e),r=[];return t?(t.type&&c.includes(t.type)||r.push(`画像の形式はjpgかpngのみ有効です。type:${t.type}`),1280!==t.width&&r.push(`画像の横幅は1280pxである必要があります。width:${t.width}`),512!==t.height&&r.push(`画像の縦幅は512pxである必要があります。height:${t.height}`),r):(r.push("画像が不正です。"),r)}},260:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.fileCapacityCheck=void 0;const o=n(r(561)),a=r(722),i=r(454),s=r(920);t.fileCapacityCheck=e=>{let t=0;t+=l(`${e}/${a.MD_NAME}`),(0,i.readDirectory)(`${e}${a.IMAGE_DIR}`).forEach((r=>{t+=l(`${e}${a.IMAGE_DIR}/${r.name}`)}));const r=t/1048576,n=r>10?[`容量が10MBを超えています。size: ${Math.round(r)}MB `]:[];(0,s.printErrorLog)(["記事と画像の容量チェックを行います。"],n)};const l=e=>o.default.statSync(e).size},841:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getPath=void 0;const o=n(r(650)),a=r(154),i=n(r(282)),s=r(722);t.getPath=async()=>"development"===i.default.env.NODE_ENV?a.DEV_PATH:await l();const l=async()=>{const e=await(0,o.default)({type:"text",message:"検証を行うファイル名を入力してください。 例) 230101",name:"value"});return`${i.default.cwd()}${s.ENTRY_DIR}/${e.value}`}},757:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.notNull=void 0,t.notNull=e=>null!=e},920:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.printErrorLog=void 0;const n=r(722);t.printErrorLog=(e,t)=>{console.log(`${n.LOG_SEPARATOR}`),e.forEach((e=>console.log(e))),t.forEach((e=>console.warn(`${n.LOG_ERROR}${e}`))),console.log(`${n.LOG_INFO}終了`)}},454:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.readDirectory=void 0;const o=n(r(561)),a=n(r(282)),i=r(722);t.readDirectory=e=>{try{return o.default.readdirSync(e,{withFileTypes:!0})}catch(t){console.warn(`${i.LOG_ERROR}ディレクトリが存在しません。${e}`),a.default.exit(1)}}},685:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.readFile=void 0;const o=n(r(561)),a=n(r(282)),i=r(722);t.readFile=e=>{try{return o.default.readFileSync(e,"utf-8")}catch(t){console.warn(`${i.LOG_ERROR}ファイルが存在しません。${e}`),a.default.exit(1)}}},822:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.toHtml=void 0;const o=n(r(653)),a=/\n/g;t.toHtml=e=>(new o.default).render(e).split(a)},167:e=>{e.exports=require("axios")},219:e=>{e.exports=require("image-size")},653:e=>{e.exports=require("markdown-it")},650:e=>{e.exports=require("prompts")},561:e=>{e.exports=require("node:fs")},282:e=>{e.exports=require("process")},837:e=>{e.exports=require("util")}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={exports:{}};return e[n].call(a.exports,a,a.exports,r),a.exports}(()=>{const e=r(841),t=r(685),n=r(722),o=r(822),a=r(175),i=r(930),s=r(260),l=r(807),u=r(55),c=r(524);(async()=>{const r=await(0,e.getPath)(),d=(0,t.readFile)(`${r}/${n.MD_NAME}`),h=(0,o.toHtml)(d);(0,i.expiredLinkCheck)(h),(0,s.fileCapacityCheck)(r),(0,l.eyecatchCheck)(r),(0,a.articleHeadingLevelCheck)(d),(0,c.articleRelatedCheck)(d),(0,u.articleDateCheck)(h)})()})()})();